import React from "react";

interface ExpBarSVGProps {
  width?: number | string;
  height?: number | string;
  className?: string;
  style?: React.CSSProperties;
  currentXp?: number;
  nextLevelXp?: number;
}

const ExpBarSVG: React.FC<ExpBarSVGProps> = ({
  width = "100%",
  height = "100%",
  className = "",
  style,
  currentXp = 0,
  nextLevelXp = 100,
}) => {
  // Calculate the fill percentage (clamped between 0 and 100%)
  const calculateFillPercentage = () => {
    if (nextLevelXp <= 0) return 100;
    const percentage = (currentXp / nextLevelXp) * 100;
    return Math.min(Math.max(percentage, 0), 100);
  };

  const fillPercentage = calculateFillPercentage();

  // Create a unique ID for this instance of the SVG
  // This prevents issues when multiple SVGs are on the same page
  const uniqueId = React.useId();
  const outerPathId = `expBarOuter-${uniqueId}`;
  const innerPathId = `expBarInner-${uniqueId}`;
  const gradientId = `expGradient-${uniqueId}`;
  const clipPathId = `expBarClip-${uniqueId}`;

  return (
    <svg
      xmlns="http://www.w3.org/2000/svg"
      xmlnsXlink="http://www.w3.org/1999/xlink"
      width={width}
      zoomAndPan="magnify"
      viewBox="307 271 408 34"
      height={height}
      style={style}
      className={className}
      preserveAspectRatio="xMidYMid meet"
      version="1.0"
    >
      <defs>
        {/* Define the outer frame path - using the precise path from original */}
        <path
          id={outerPathId}
          d="M 419.140625 295.007812 C 419.382812 293.09375 419.339844 290.808594 419.851562 288.597656 C 420.363281 286.378906 421.714844 284.863281 423.84375 284.105469 C 424.175781 283.988281 424.46875 283.984375 424.449219 283.476562 C 424.4375 283.109375 424.824219 283.152344 425.070312 283.214844 C 426.25 283.527344 427.46875 283.414062 428.664062 283.574219 C 430.507812 283.820312 432.382812 283.703125 434.230469 283.523438 C 438.117188 283.136719 442.019531 282.949219 445.914062 282.703125 C 449.09375 282.5 452.269531 282.269531 455.445312 282.070312 C 457.527344 281.941406 459.613281 281.902344 461.695312 281.8125 C 467.339844 281.570312 472.988281 281.457031 478.632812 281.21875 C 483.554688 281.007812 488.472656 280.691406 493.394531 280.433594 C 495.816406 280.308594 498.246094 280.257812 500.667969 280.101562 C 507.515625 279.664062 514.378906 279.542969 521.230469 279.152344 C 527.515625 278.792969 533.808594 278.65625 540.101562 278.484375 C 551.855469 278.167969 563.613281 278.316406 575.367188 278.496094 C 583.066406 278.613281 590.765625 278.640625 598.460938 278.808594 C 604 278.929688 609.535156 278.894531 615.070312 279.050781 C 620.644531 279.207031 626.210938 279.46875 631.78125 279.679688 C 636.214844 279.847656 640.648438 279.988281 645.078125 280.1875 C 649.472656 280.382812 653.863281 280.621094 658.25 280.882812 C 660.785156 281.03125 663.316406 281.226562 665.855469 281.332031 C 666.667969 281.367188 667.484375 281.632812 668.269531 281.878906 C 668.878906 282.066406 669.253906 282.578125 669.519531 283.152344 C 669.976562 284.140625 670.234375 285.179688 670.128906 286.277344 C 669.8125 289.523438 669.65625 292.785156 669.199219 296.019531 C 669.070312 296.929688 669.003906 297.847656 668.789062 298.746094 C 668.355469 300.582031 667.640625 301.171875 665.765625 301.191406 C 665.613281 301.191406 665.453125 301.21875 665.3125 301.171875 C 663.660156 300.621094 662.003906 301.054688 660.359375 301.175781 C 655.859375 301.507812 651.367188 301.921875 646.871094 302.242188 C 643.121094 302.507812 639.363281 302.410156 635.609375 302.476562 C 629.386719 302.589844 623.171875 302.390625 616.957031 302.238281 C 612.898438 302.136719 608.832031 302.21875 604.785156 302.003906 C 595.992188 301.535156 587.183594 301.957031 578.398438 301.523438 C 569.867188 301.101562 561.339844 301.117188 552.808594 301.132812 C 548.859375 301.136719 544.933594 301.585938 540.988281 301.640625 C 537.121094 301.691406 533.25 301.699219 529.382812 301.824219 C 522.5625 302.050781 515.730469 302.066406 508.914062 302.347656 C 502.472656 302.609375 496.03125 302.84375 489.59375 303.242188 C 484.902344 303.53125 480.214844 303.8125 475.511719 303.9375 C 471.6875 304.042969 467.875 304.519531 464.035156 304.449219 C 461.800781 304.40625 459.5625 304.453125 457.328125 304.53125 C 455.5 304.59375 453.699219 304.84375 451.902344 305.101562 C 448.964844 305.527344 446.011719 305.675781 443.054688 305.570312 C 439.675781 305.449219 436.3125 305.492188 432.941406 305.761719 C 431.125 305.90625 429.289062 305.894531 427.523438 305.363281 C 424.675781 304.511719 422.324219 302.808594 420.53125 300.46875 C 419.433594 299.039062 419.074219 297.203125 419.140625 295.007812 Z M 631.640625 300.828125 C 635.277344 300.578125 639.375 300.746094 643.46875 300.675781 C 644.265625 300.664062 645.0625 300.648438 645.855469 300.589844 C 648.84375 300.378906 651.828125 300.152344 654.8125 299.925781 C 656.171875 299.824219 657.527344 299.644531 658.890625 299.601562 C 661.128906 299.53125 663.324219 299.035156 665.566406 299.023438 C 666.480469 299.019531 666.527344 299.007812 666.671875 298.09375 C 666.910156 296.578125 667.140625 295.054688 667.257812 293.527344 C 667.410156 291.5 667.558594 289.472656 667.824219 287.453125 C 667.945312 286.539062 667.992188 285.617188 667.835938 284.699219 C 667.742188 284.164062 667.503906 283.742188 666.925781 283.6875 C 665.527344 283.550781 664.203125 283.019531 662.796875 282.9375 C 661.511719 282.863281 660.222656 282.765625 658.9375 282.703125 C 652.15625 282.375 645.378906 282.003906 638.597656 281.738281 C 630.566406 281.421875 622.53125 281.078125 614.496094 280.953125 C 598.644531 280.703125 582.792969 280.539062 566.941406 280.457031 C 557.234375 280.40625 547.523438 280.261719 537.816406 280.601562 C 533.914062 280.738281 530.003906 280.726562 526.105469 280.945312 C 518 281.402344 509.882812 281.496094 501.78125 281.960938 C 496.214844 282.277344 490.644531 282.445312 485.078125 282.710938 C 478.03125 283.050781 470.976562 283.101562 463.925781 283.371094 C 460.667969 283.492188 457.40625 283.5625 454.148438 283.714844 C 450.097656 283.902344 446.050781 284.207031 441.996094 284.324219 C 440.101562 284.375 438.210938 284.570312 436.320312 284.679688 C 433.785156 284.824219 431.230469 285.066406 428.710938 284.6875 C 427.253906 284.46875 425.941406 284.71875 424.601562 285.132812 C 422.726562 285.714844 421.515625 287.011719 421.214844 288.929688 C 420.84375 291.273438 420.582031 293.652344 420.523438 296.023438 C 420.476562 297.921875 421.21875 299.605469 422.824219 300.792969 C 423.804688 301.519531 424.78125 302.246094 425.828125 302.871094 C 426.714844 303.398438 427.664062 303.738281 428.683594 303.925781 C 430.382812 304.242188 432.089844 304.210938 433.785156 304.042969 C 436.210938 303.804688 438.628906 303.8125 441.054688 303.875 C 444.085938 303.957031 447.121094 304.066406 450.144531 303.683594 C 451.457031 303.519531 452.773438 303.363281 454.089844 303.195312 C 457.109375 302.808594 460.144531 302.9375 463.179688 302.90625 C 464.582031 302.890625 465.984375 302.925781 467.386719 302.851562 C 470.1875 302.703125 472.980469 302.375 475.78125 302.335938 C 480.636719 302.269531 485.476562 301.960938 490.320312 301.648438 C 495.691406 301.296875 501.074219 301.226562 506.453125 300.933594 C 510.351562 300.722656 514.257812 300.707031 518.164062 300.648438 C 525.976562 300.53125 533.777344 300.09375 541.59375 300.164062 C 542.046875 300.167969 542.5 300.113281 542.957031 300.085938 C 545.945312 299.90625 548.929688 299.640625 551.921875 299.5625 C 555.863281 299.457031 559.808594 299.496094 563.753906 299.46875 C 568.609375 299.433594 573.453125 299.730469 578.304688 299.902344 C 583.648438 300.09375 588.996094 299.988281 594.34375 299.984375 C 596.015625 299.980469 597.6875 299.941406 599.351562 300.039062 C 603.25 300.269531 607.152344 300.421875 611.058594 300.421875 C 612.726562 300.425781 614.394531 300.4375 616.0625 300.492188 C 621.101562 300.660156 626.140625 300.917969 631.640625 300.828125 Z M 631.640625 300.828125 "
        />

        {/* Define the inner path with precise coordinates to match the outer path but slightly inset */}
        <path
          id={innerPathId}
          d="M 420.140625 294.507812 C 421.382812 292.59375 421.339844 290.308594 421.851562 288.097656 C 422.363281 285.878906 423.714844 284.363281 425.84375 283.605469 C 426.175781 283.488281 426.46875 283.484375 426.449219 282.976562 C 426.4375 282.609375 426.824219 282.652344 427.070312 282.714844 C 428.25 283.027344 429.46875 282.914062 430.664062 283.074219 C 432.507812 283.320312 434.382812 283.203125 436.230469 283.023438 C 440.117188 282.636719 444.019531 282.449219 447.914062 282.203125 C 451.09375 282 454.269531 281.769531 457.445312 281.570312 C 459.527344 281.441406 461.613281 281.402344 463.695312 281.3125 C 469.339844 281.070312 474.988281 280.957031 480.632812 280.71875 C 485.554688 280.507812 490.472656 280.191406 495.394531 279.933594 C 497.816406 279.808594 500.246094 279.757812 502.667969 279.601562 C 509.515625 279.164062 516.378906 279.042969 523.230469 278.652344 C 529.515625 278.292969 535.808594 278.15625 542.101562 277.984375 C 553.855469 277.667969 565.613281 277.816406 577.367188 277.996094 C 585.066406 278.113281 592.765625 278.140625 600.460938 278.308594 C 606 278.429688 611.535156 278.394531 617.070312 278.550781 C 622.644531 278.707031 628.210938 278.96875 633.78125 279.179688 C 638.214844 279.347656 642.648438 279.488281 647.078125 279.6875 C 651.472656 279.882812 655.863281 280.121094 660.25 280.382812 C 662.785156 280.53125 665.316406 280.726562 667.855469 280.832031 C 668.667969 280.867188 669.484375 281.132812 670.269531 281.378906 C 670.878906 281.566406 671.253906 282.078125 671.519531 282.652344 C 671.976562 283.640625 672.234375 284.679688 672.128906 285.777344 C 671.8125 289.023438 671.65625 292.285156 671.199219 295.519531 C 671.070312 296.429688 671.003906 297.347656 670.789062 298.246094 C 670.355469 300.082031 669.640625 300.671875 667.765625 300.691406 C 667.613281 300.691406 667.453125 300.71875 667.3125 300.671875 C 665.660156 300.121094 664.003906 300.554688 662.359375 300.675781 C 657.859375 301.007812 653.367188 301.421875 648.871094 301.742188 C 645.121094 302.007812 641.363281 301.910156 637.609375 301.976562 C 631.386719 302.089844 625.171875 301.890625 618.957031 301.738281 C 614.898438 301.636719 610.832031 301.71875 606.785156 301.503906 C 597.992188 301.035156 589.183594 301.457031 580.398438 301.023438 C 571.867188 300.601562 563.339844 300.617188 554.808594 300.632812 C 550.859375 300.636719 546.933594 301.085938 542.988281 301.140625 C 539.121094 301.191406 535.25 301.199219 531.382812 301.324219 C 524.5625 301.550781 517.730469 301.566406 510.914062 301.847656 C 504.472656 302.109375 498.03125 302.34375 491.59375 302.742188 C 486.902344 303.03125 482.214844 303.3125 477.511719 303.4375 C 473.6875 303.542969 469.875 304.019531 466.035156 303.949219 C 463.800781 303.90625 461.5625 303.953125 459.328125 304.03125 C 457.5 304.09375 455.699219 304.34375 453.902344 304.601562 C 450.964844 305.027344 448.011719 305.175781 445.054688 305.070312 C 441.675781 304.949219 438.3125 304.992188 434.941406 305.261719 C 433.125 305.40625 431.289062 305.394531 429.523438 304.863281 C 426.675781 304.011719 424.324219 302.308594 422.53125 299.96875 C 421.433594 298.539062 421.074219 296.703125 421.140625 294.507812 Z"
        />

        {/* Clip path for the inner fill */}
        <clipPath id={clipPathId}>
          <use href={`#${innerPathId}`} />
        </clipPath>

        {/* Linear gradient for fill */}
        <linearGradient id={gradientId} x1="0%" y1="0%" x2="100%" y2="0%">
          <stop offset="0%" stopColor="#6366f1" />
          <stop offset="100%" stopColor="#8b5cf6" />
        </linearGradient>
      </defs>

      {/* Background/frame of the bar */}
      <use
        href={`#${outerPathId}`}
        fill="#1a1817"
        fillOpacity="1"
        fillRule="nonzero"
      />

      {/* Fill the inner area with a dark color */}
      <use href={`#${innerPathId}`} fill="#272622" fillRule="nonzero" />

      {/* Progress fill that fills the inner area */}
      <g clipPath={`url(#${clipPathId})`}>
        {/* Gradient fill based on percentage */}
        <rect
          x="420"
          y="278"
          width="252"
          height="25"
          fill={`url(#${gradientId})`}
          fillOpacity="0.9"
          clipPath={`inset(0 ${100 - fillPercentage}% 0 0)`}
        />

        {/* Inner glow/highlight for the filled area */}
        <rect
          x="420"
          y="287"
          width="252"
          height="3"
          fill="white"
          fillOpacity="0.2"
          clipPath={`inset(0 ${100 - fillPercentage}% 0 0)`}
        />
      </g>

      {/* Optional shine effect on top of fill */}
      <g clipPath={`url(#${clipPathId})`} opacity="0.4">
        <ellipse
          cx="545"
          cy="285"
          rx="120"
          ry="1.5"
          fill="white"
          clipPath={`inset(0 ${100 - fillPercentage}% 0 0)`}
        />
      </g>
    </svg>
  );
};

export default ExpBarSVG;
